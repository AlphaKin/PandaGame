{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\script\\blocks/assets\\script\\blocks\\block_boom.js"],"names":["com","require","cc","Class","extends","Component","properties","parts","Prefab","audio","AudioClip","isBoom","_isContacted","onBeginContact","contact","self","other","node","group","boom","audioEngine","play","bp","getComponent","MAP_OBJ","x","y","part","instantiate","find","addChild","setPosition","getPosition","score","dir","forEach","item","index","array","xx","yy","MAP_WIDTH","MAP_HEIGHT","block","sptName","spt_name","alert","console","log","destroy","start"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAIA,MAAMC,QAAQ,QAAR,CAAV;AACAC,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,eAAOL,GAAGM,MADF;AAERC,eAAOP,GAAGQ,SAFF;AAGRC,gBAAQ,KAHA;AAIRC,sBAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAnBQ,KAHP;;AAyBL;;AAEA;AACAC,kBA5BK,0BA4BUC,OA5BV,EA4BmBC,IA5BnB,EA4ByBC,KA5BzB,EA4B+B;AAChC,YAAG,KAAKJ,YAAL,IAAqBI,MAAMC,IAAN,CAAWC,KAAX,IAAoB,MAA5C,EAAmD;AAC/C,iBAAKC,IAAL;AACA,iBAAKP,YAAL,GAAoB,KAApB;AACH;AACJ,KAjCI;AAkCLO,QAlCK,kBAkCC;AACFjB,WAAGkB,WAAH,CAAeC,IAAf,CAAoB,KAAKZ,KAAzB,EAAgC,KAAhC,EAAuC,CAAvC;AACA,YAAIa,KAAK,KAAKL,IAAL,CAAUM,YAAV,CAAuB,UAAvB,CAAT;AACAvB,YAAIwB,OAAJ,CAAYF,GAAGG,CAAf,EAAkBH,GAAGI,CAArB,IAA0B,IAA1B;AACA,YAAIC,OAAOzB,GAAG0B,WAAH,CAAe,KAAKrB,KAApB,CAAX;AACAL,WAAG2B,IAAH,CAAQ,eAAR,EAAyBC,QAAzB,CAAkCH,IAAlC;AACAA,aAAKI,WAAL,CAAiB,KAAKd,IAAL,CAAUe,WAAV,EAAjB;AACAhC,YAAIiC,KAAJ,GAAYjC,IAAIiC,KAAJ,GAAY,CAAxB;AACA,YAAMC,MAAM,CAAC,CAAC,CAAC,CAAF,EAAI,CAAJ,CAAD,EAAQ,CAAC,CAAD,EAAG,CAAH,CAAR,EAAc,CAAC,CAAD,EAAG,CAAC,CAAJ,CAAd,EAAqB,CAAC,CAAD,EAAG,CAAH,CAArB,EAA2B,CAAC,CAAC,CAAF,EAAI,CAAC,CAAL,CAA3B,EAAmC,CAAC,CAAD,EAAG,CAAH,CAAnC,EAAyC,CAAC,CAAC,CAAF,EAAI,CAAJ,CAAzC,EAAgD,CAAC,CAAD,EAAG,CAAC,CAAJ,CAAhD,CAAZ;AACAA,YAAIC,OAAJ,CAAY,UAACC,IAAD,EAAMC,KAAN,EAAYC,KAAZ,EAAsB;AAC9B,gBAAIC,KAAKjB,GAAGG,CAAH,GAAOW,KAAK,CAAL,CAAhB;AACA,gBAAII,KAAKlB,GAAGI,CAAH,GAAOU,KAAK,CAAL,CAAhB;AACA,gBAAGG,KAAKvC,IAAIyC,SAAT,IAAsBF,MAAM,CAA5B,IAAiCC,KAAKxC,IAAI0C,UAA1C,IAAwDF,MAAM,CAAjE,EAAmE;AAC/D,oBAAIG,QAAQ3C,IAAIwB,OAAJ,CAAYe,EAAZ,EAAgBC,EAAhB,CAAZ;AACA,oBAAGG,SAAS,IAAZ,EAAiB;AACb,wBAAIC,UAAUD,MAAMpB,YAAN,CAAmB,UAAnB,EAA+BsB,QAA7C;AACA,wBAAGD,WAAW,IAAd,EAAmB;AACf,4BAAGA,WAAW,YAAd,EAA2B;AACvBE,kCAAM,WAAN;AACH,yBAFD,MAEK;AACDC,oCAAQC,GAAR,CAAYJ,UAAU,GAAV,GAAgBL,EAAhB,GAAoB,GAApB,GAA0BC,EAA1B,GAA+B,aAA3C;AACAG,kCAAMpB,YAAN,CAAmBqB,OAAnB,EAA4BzB,IAA5B;AACH;AACJ;AACJ;AACJ;AACJ,SAjBD;AAkBA,aAAKF,IAAL,CAAUgC,OAAV;AACH,KA9DI;AA+DLC,SA/DK,mBA+DI,CACR;AAhEI;;AAkEL;AACA;AAnEJ","file":"block_boom.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\blocks","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nvar com = require('common');\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        parts: cc.Prefab,\r\n        audio: cc.AudioClip,\r\n        isBoom: false,\r\n        _isContacted: true\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n    onBeginContact(contact, self, other){\r\n        if(this._isContacted && other.node.group == \"ball\"){\r\n            this.boom();\r\n            this._isContacted = false;\r\n        }\r\n    },\r\n    boom(){\r\n        cc.audioEngine.play(this.audio, false, 1);\r\n        let bp = this.node.getComponent(\"position\");\r\n        com.MAP_OBJ[bp.x][bp.y] = null;\r\n        let part = cc.instantiate(this.parts);\r\n        cc.find(\"Canvas/blocks\").addChild(part);\r\n        part.setPosition(this.node.getPosition());\r\n        com.score = com.score - 5;\r\n        const dir = [[-1,0],[1,0],[0,-1],[0,1],[-1,-1],[1,1],[-1,1],[1,-1]];\r\n        dir.forEach((item,index,array) => {\r\n            let xx = bp.x + item[0];\r\n            let yy = bp.y + item[1];\r\n            if(xx < com.MAP_WIDTH && xx >= 0 && yy < com.MAP_HEIGHT && yy >= 0){\r\n                let block = com.MAP_OBJ[xx][yy];\r\n                if(block != null){\r\n                    let sptName = block.getComponent(\"position\").spt_name;\r\n                    if(sptName != null){\r\n                        if(sptName == \"block_pass\"){\r\n                            alert(\"game over\");\r\n                        }else{\r\n                            console.log(sptName + \"(\" + xx +\",\" + yy + \") will boom\")\r\n                            block.getComponent(sptName).boom();\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        this.node.destroy();\r\n    },\r\n    start () {\r\n    },\r\n\r\n    // update (dt) {\r\n    // },\r\n});\r\n"]}